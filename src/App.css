/************************************************************
 * App.css — background image + stable, mobile-friendly base
 * - Stadium photo renders behind the whole app (via BackgroundLayer.jsx)
 * - Glassmorphic surfaces stay translucent (no solid blue)
 * - Mobile-safe fallbacks to avoid flicker/tearing
 * ⭐ RP-ZOOM-FIX: works together with viewport meta to keep layout stable
 ************************************************************/

/* ===== App layout ===== */
.App {
  text-align: center;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
main {
  flex: 1;
}

/* ===== Global base ===== */
:root,
html,
body,
#root {
  min-height: 100%;
  height: auto;
  overflow-x: hidden; /* prevents 1px horizontal jitter */
  -webkit-font-smoothing: antialiased;
  -webkit-overflow-scrolling: touch; /* smooth iOS scroll */
  overscroll-behavior-y: contain; /* reduce over-scroll compositing */
}

body {
  margin: 0;
}

/* ⭐ RP-ZOOM-FIX: make sure our custom body class never paints a solid bg */
body.crickedge-body {
  background: transparent !important;
}

/* ------------------------------------------------------------------
   We do NOT draw the stadium background on <body>.
   Background lives in <BackgroundLayer/> / .ce-bg-layer behind the app.
   ------------------------------------------------------------------ */

/* ===== BackgroundLayer safety styles (backup to the component CSS) ===== */
.ce-bg-layer {
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  contain: strict; /* isolate paints */
  will-change: transform;
}
.ce-bg-layer__img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  will-change: transform;
  filter: none;
}

/* Prevent theme utilities from painting solid backgrounds */
.dark,
body.dark,
#root.dark,
.light,
body.light,
#root.light,
body.bg-dark {
  background: transparent !important;
  color: inherit;
  transition: color 0.3s;
}

/* ===== Touch polish ===== */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Promote heavy surfaces to GPU layers (NOT the body) */
.card,
.bg-dark:not(body),
.crickedge-footer,
.navbar,
header {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
}

/* ===== App header (transparent) ===== */
.App-header {
  background: transparent; /* was solid #171922 */
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: #fff;
}

/* ===== Cards — glass panels ======================================= */
/* Cards stay slightly dark but MUCH more transparent */
.card {
  background: rgba(18, 24, 40, 0.24) !important; /* lighter alpha */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border-radius: 1.2em;
  box-shadow: 0 2px 18px rgba(0, 0, 0, 0.55);
}

/* Any Bootstrap .bg-dark or .dark wrapper → transparent */
.bg-dark:not(body),
.dark:not(body) {
  background: transparent !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* On smaller screens, tone blur down to avoid artifacts
   but KEEP a lighter, semi-transparent fill for cards */
@media (max-width: 768px) {
  .card {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(12, 20, 34, 0.75) !important;
  }

  /* still no strip on mobile */
  .bg-dark:not(body),
  .dark:not(body) {
    background: transparent !important;
  }
}

/* ===== Links ===== */
a,
.App-link {
  color: #ffe066;
  transition: color 0.2s;
  text-decoration: none;
}
a:hover {
  color: #ffb800;
  text-decoration: underline;
}
.light a,
.light .App-link {
  color: #0d6efd;
}
.light a:hover {
  color: #00b3ff;
}

/* Text selection */
::selection {
  background: #ffd40080;
}

/* ===== Footer (legacy class; ce-footer is styled inline in component) ===== */
.crickedge-footer {
  width: 100%;
  background: rgba(10, 10, 10, 0.75); /* translucent over the image */
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 14px 0 2px 0;
  margin: 0 auto;
  box-shadow: 0 -2px 30px #0006;
}
.footer-logo-img {
  width: 120px;
  margin-bottom: 6px;
  filter: drop-shadow(0 0 20px #ffd70066);
  border-radius: 12px;
}
.footer-copy {
  font-size: 1em;
  color: #ffd700;
  font-weight: 500;
  letter-spacing: 1.2px;
  margin-bottom: 0;
}
.crickedge-name {
  font-weight: 700;
  color: #ffe066;
}
@media (max-width: 600px) {
  .footer-logo-img {
    width: 85px;
  }
  .footer-copy {
    font-size: 0.95em;
  }
  .crickedge-footer {
    padding: 10px 0 0 0;
  }
}

/* ===== Animations ===== */
.App-logo {
  height: 40vmin;
  pointer-events: none;
}
@keyframes App-logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}
@media (prefers-reduced-motion: no-preference) {
  .App-logo {
    animation: App-logo-spin infinite 20s linear;
  }
}

/* ==========================================================
   COMPONENT-SPECIFIC STABILITY (leaderboard & match tables)
   ========================================================== */

/* Always promote these surfaces to dedicated GPU layers */
.leaderboard-glass,
.lbfx-glass, /* alt leaderboard wrapper */
.trfx-glass, /* TestRanking wrapper */
.mhfx-glass, /* MatchHistory wrapper */
.nrr-track,
.nrr-bar,
.win-track,
.win-bar {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
}

/* Touch devices & small screens: disable heavy effects */
@media (max-width: 900px), (pointer: coarse) {
  /* Kill backdrop blur on glass cards to stop last flickers */
  .leaderboard-glass,
  .lbfx-glass,
  .trfx-glass,
  .mhfx-glass {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(13, 31, 47, 0.82) !important;
    box-shadow: 0 10px 26px rgba(0, 0, 0, 0.35);
  }

  /* Remove 3D hover/tilt transforms that thrash layers on touch */
  .lb-row,
  .mhfx-row,
  .trfx-row {
    transform: none !important;
    transition: background-color 0.18s ease !important;
    box-shadow: none !important;
  }

  /* Remove expensive filters on animated bars/icons */
  .nrr-bar,
  .win-bar,
  .trophy {
    filter: none !important;
  }

  /* Particles add translucent layers while scrolling—hide on mobile */
  #lbfx-particles,
  #trfx-particles,
  #mhfx-particles {
    display: none !important;
  }
}

/* If some page sets body.bg-dark (Bootstrap), keep transparent */
body.bg-dark {
  background: transparent !important;
}

/* ==========================================================
   ROW/BLOCK “BREAKING” FIXES (no wrapping / no clipping)
   ========================================================== */

/* 1) tables use fixed layout for consistent column widths */
.leaderboard-table,
.trfx-table,
.mhfx-table {
  table-layout: fixed;
  width: 100%;
}

/* 2) keep cell content in a single line; ellipsize instead of wrapping */
.leaderboard-table thead th,
.leaderboard-table tbody td,
.trfx-table .th,
.trfx-table .td,
.mhfx-table thead th,
.mhfx-table tbody td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 3) isolate each row so effects don't bleed into neighbors */
.leaderboard-table tbody tr,
.mhfx-table tbody tr,
.trfx-table .tr-row,
.trfx-row {
  isolation: isolate; /* new stacking context per row */
}

/* 4) NRR / Winner cells must be allowed to show glow without clipping */
.leaderboard-table td.nrr-cell,
.mhfx-table td.mhfx-winner {
  position: relative;
  overflow: visible;
}

/* 5) Tighter spacing on small screens for better fit */
@media (max-width: 768px) {
  .leaderboard-table thead th,
  .leaderboard-table tbody td,
  .mhfx-table thead th,
  .mhfx-table tbody td {
    padding: 10px 8px !important;
    font-size: 14px !important;
  }
}

/* =========================================================
   Samsung S23 Ultra (Chrome, high-DPR) stability overrides
   ========================================================= */
@media (pointer: coarse) and (-webkit-min-device-pixel-ratio: 2) {
  .leaderboard-glass,
  .lbfx-glass,
  .trfx-glass,
  .mhfx-glass {
    background: rgba(15, 27, 40, 0.84) !important;
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.28) !important;
    border: 1px solid rgba(255, 255, 255, 0.06) !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
  .leaderboard-glass::before,
  .leaderboard-glass::after,
  .lbfx-glass::before,
  .lbfx-glass::after,
  .trfx-glass::before,
  .trfx-glass::after,
  .mhfx-glass::before,
  .mhfx-glass::after {
    content: none !important;
  }

  .leaderboard-table,
  .trfx-table,
  .mhfx-table {
    border-collapse: collapse !important;
    border-spacing: 0 !important;
    table-layout: fixed !important;
  }

  .leaderboard-table tbody tr,
  .mhfx-table tbody tr {
    background: #0f1e2d !important;
    box-shadow: none !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.06) !important;
    position: relative;
    z-index: 0;
  }
  .leaderboard-table tbody td,
  .mhfx-table tbody td {
    position: relative;
    z-index: 1;
  }
}

/* ===== Strong fallbacks ===== */
@supports not ((backdrop-filter: blur(2px)) or (-webkit-backdrop-filter: blur(2px))) {
  .card {
    background: rgba(15, 27, 40, 0.76) !important; /* lighter than old .88 */
  }

  .bg-dark:not(body),
  .dark:not(body) {
    background: transparent !important;
  }

  .crickedge-footer {
    background: rgba(10, 10, 10, 0.86);
  }
}

/* =======================================================
   ✨ CRICKEDGE WATERMARK BACKGROUND (light, transparent)
   ======================================================= */
.crickedge-bg {
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;

  /* Only a very soft light glow in the middle. */
  background: radial-gradient(
    circle at center,
    rgba(255, 213, 124, 0.08),
    transparent 65%
  );

  filter: saturate(105%);
}

/* Keep just the faint text watermark */
.crickedge-bg::before,
.crickedge-bg::after {
  content: "CRICKEDGE.IN  CRICKEDGE.IN  CRICKEDGE.IN  CRICKEDGE.IN";
  position: absolute;
  left: -12rem;
  right: -12rem;
  font-weight: 800;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: rgba(255, 213, 124, 0.055);
  font-size: clamp(3.4rem, 8vw, 6.2rem);
  pointer-events: none;
  user-select: none;
  white-space: nowrap;
}

.crickedge-bg::before {
  top: 6vh;
  transform: rotate(-17deg);
}

.crickedge-bg::after {
  top: 46vh;
  transform: rotate(-17deg);
  opacity: 0.045;
}

@media (max-width: 768px) {
  .crickedge-bg::before,
  .crickedge-bg::after {
    font-size: 3rem;
    opacity: 0.03;
  }
  .crickedge-bg::before {
    top: 9vh;
  }
  .crickedge-bg::after {
    top: 60vh;
  }
}

/* =======================================================
   STEP 3 / FINAL OVERRIDE: nuke any solid strip
   ======================================================= */

/* Kill background on the <body class="bg-dark text-light"> itself */
body.bg-dark,
body.bg-dark.text-light {
  background: transparent !important;
  background-color: transparent !important;
}

/* Kill any top-level dark wrappers under #root */
#root > .bg-dark,
#root > .dark,
body.bg-dark .bg-dark,
body.bg-dark .dark {
  background: transparent !important;
  background-color: transparent !important;
  box-shadow: none !important;
}

/* Also ensure the watermark layer never darkens the center */
.crickedge-bg {
  background-color: transparent !important;
}
